<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Getting stated with models &mdash; NIST Scan Framework For ARTIQ 2.1.0 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Configuring fits" href="fitting.html" />
    <link rel="prev" title="Using models for data processing" href="../models.html" /> 
<script async type="text/javascript" id="_fed_an_ua_tag" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=NIST&subagency=github&pua=UA-66610693-1&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c">
</script>
  <link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">  
  <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>
  <!--<script type="text/javascript" src="https://pages.nist.gov/leaveNotice/js/jquery.leaveNotice-nist.min.js"></script>-->
  <link rel="stylesheet" type="text/css" href="https://pages.nist.gov/leaveNotice/css/jquery.leaveNotice.css" />  
  <script type="text/javascript">
	  function link_is_external(link_element) {
	      return (link_element.host !== window.location.host);
	  }
	  (function ($) {
	      $.fn.leaveNotice = function (opt) {
	          var defaults = {
	              siteName: "NIST",
	              exitMessage:
	                  "<h2><strong>Thank you for visiting {SITENAME}.</strong></h2><p>We hope your visit was informative.</p><p>We have provided this link to a non-NIST site because it has information that may be of interest to our users. NIST does not necessarily endorse the views expressed or the facts presented on this site. Further, NIST does not endorse any commercial products that may be advertised or available on this site.</p>",
	              preLinkMessage: "<div class='setoff'><p>You will now be directed to:<br/>{URL}</p></div>",
	              linkString: "",
	              newWindow: false,
	              timeOut: 1e4,
	              overlayId: "ln-blackout",
	              messageBoxId: "ln-messageBox",
	              messageHolderId: "ln-messageHolder",
	              linkId: "ln-link",
	              displayUrlLength: 50,
	              overlayAlpha: 0.3,
	          };
	          var options = $.extend(defaults, opt);
	          return this.each(function () {
				  if(link_is_external(this)) {
		              el = $(this);
					  $(this).unbind();
		              var url = el.attr("href");
		              var ulen = options.displayUrlLength;
		              if (url.length >= ulen) {
		                  var suffix = "...";
		              } else {
		                  var suffix = "";
		              }
		              var shortUrl = url.substr(0, ulen) + suffix;
		              var title = el.attr("title");
		              if (title === undefined || title == "") {
		                  var linkText = shortUrl;
		              } else {
		                  var linkText = title;
		              }
		              options.timeOut = options.newWindow ? 0 : options.timeOut;
		              el.click(function (event) {
						  event.preventDefault();
		                  $("body").append('<div id="' + options.overlayId + '"></div>');
		                  $("body").append('<div id="' + options.messageHolderId + '"><div id="' + options.messageBoxId + '"></div></div>');
		                  if (options.overlayAlpha !== false) {
		                      $("#" + options.overlayId).css("opacity", options.overlayAlpha);
		                  }
		                  preFilteredContent = options.exitMessage + options.preLinkMessage;
		                  msgContent = preFilteredContent.replace(/\{URL\}/g, '<a id="' + options.linkId + '" href="' + url + '" title="' + url + '"' + options.linkString + ">" + linkText + "</a>");
		                  msgContent = msgContent.replace(/\{SITENAME\}/g, options.siteName);
		                  if (options.timeOut > 0) {
		                      msgContent += '<p id="ln-cancelMessage"><a href="#close" id="ln-cancelLink">Cancel</a> or press the ESC key.</p>';
		                  } else {
		                      msgContent += '<p id="ln-cancelMessage">Click the link above to continue or <a href="#close" id="ln-cancelLink">Cancel</a></p>';
		                  }
		                  $("#" + options.messageBoxId).append(msgContent);
		                  if (options.timeOut > 0) {
		                      leaveIn = setTimeout(function () {
		                          $("#ln-cancelMessage").html("<em>Loading...</em>");
		                          window.location.href = url;
		                      }, options.timeOut);
		                  } else {
		                      leaveIn = false;
		                  }
		                  if (options.newWindow) {
		                      $("a#" + options.linkId)
		                          .attr("target", "_blank")
		                          .click(function () {
		                              closeDialog(options, leaveIn);
		                          });
		                  }
		                  $("#ln-cancelLink").click(function () {
		                      closeDialog(options, leaveIn);
		                      return false;
		                  });
		                  $(document).bind("keyup", function (e) {
		                      if (e.which == 27) {
		                          closeDialog(options, leaveIn);
		                      }
		                  });
		                  $(window).unload(function () {
		                      closeDialog(options, leaveIn);
		                  });
		                  return false;
		              });
				  }
	          });
	      };
	      function closeDialog(options, timer) {
	          if (options.timeOut > 0) {
	              clearTimeout(timer);
	          }
	          $("#" + options.overlayId + ", #" + options.messageHolderId).fadeOut("fast", function () {
	              $("#" + options.overlayId + ", #" + options.messageHolderId).remove();
	          });
	          $(document).unbind("keyup");
	      }
	  })(jQuery);
	  
  	$(function(){
  	  $('a').leaveNotice();
  	});
  </script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> NIST Scan Framework For ARTIQ
          </a>
              <div class="version">
                2.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Installing the NIST scan framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scans.html">Creating scan experiments</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../models.html">Using models for data processing</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Getting stated with models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#namespaces">Namespaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="#re-binding">Re-Binding</a></li>
<li class="toctree-l3"><a class="reference internal" href="#broadcast-persist-save">Broadcast, Persist, &amp; Save</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataset-mirroring">Dataset Mirroring</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="fitting.html">Configuring fits</a></li>
<li class="toctree-l2"><a class="reference internal" href="validators.html">Validating fitted parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="plots.html">Formatting the appearance of plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="accessing_scan.html">Accessing the scan inside a scan model</a></li>
<li class="toctree-l2"><a class="reference internal" href="histograms.html">Creating Histograms</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../scans_ref.html">Scans references and API docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models_ref.html">Models reference and API docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis.html">Curve fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applets.html">Applets</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NIST Scan Framework For ARTIQ</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../models.html">Using models for data processing</a> &raquo;</li>
      <li>Getting stated with models</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/models/getting_started.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="getting-stated-with-models">
<h1>Getting stated with models<a class="headerlink" href="#getting-stated-with-models" title="Permalink to this headline">¶</a></h1>
<div class="section" id="namespaces">
<h2>Namespaces<a class="headerlink" href="#namespaces" title="Permalink to this headline">¶</a></h2>
<p>Datasets are logically grouped under a common namespace.
Access to the datasets under a namespace is provided by defining a model and specifying it’s namespace.  Namespaces can include % prefixed tokens which are replaced by the values of class variable that have the same name.  If a corresponding class variable is not found for a token, that token will stripped out of the namespace.  For example,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">app.models.model</span> <span class="kn">import</span> <span class="o">*</span>
<span class="k">class</span> <span class="nc">MicrowavesModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">namespace</span> <span class="o">=</span> <span class="s1">&#39;microwaves.%transition.</span><span class="si">%f</span><span class="s1">oo&#39;</span>  <span class="c1">#: Dataset namespace</span>

<span class="k">class</span> <span class="nc">MyExperiment</span><span class="p">(</span><span class="n">EnvExperiment</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">MicrowavesModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transition</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="o">*</span><span class="n">MHz</span><span class="p">)</span>
</pre></div>
</div>
<p>will print <strong>“microwaves.1”</strong> (the namespace) and write 500,000,000 to the dataset <strong>“microwaves.1.frequency”</strong></p>
</div>
<div class="section" id="re-binding">
<h2>Re-Binding<a class="headerlink" href="#re-binding" title="Permalink to this headline">¶</a></h2>
<p>A model can be re-bound to it’s namespace at any time as class variables are either added or changed by calling the model’s bind() method  e.g. <cite>self.model.bind()</cite>.  The current class variable values are used to fill out the namespace just as is done when the model is instantiated.  This allows for dynamic rebinding of a model to different namespaces.  An example is a single microwaves model which rebinds to different transitions to read pi times and frequencies as opposed to having one model for each transition.  If a token was stripped out of the namespace in a previous bind(), it is still apart of the namespace and can be used in future binds() once the class variable has been set.  Following the above example,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyExperiment</span><span class="p">(</span><span class="n">EnvExperiment</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">MicrowavesModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transition</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">bind</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>
</pre></div>
</div>
<p>will print <strong>“microwaves.1”</strong> (the first namespace), followed by <strong>microwaves.1.bar</strong> (the second namespace)</p>
</div>
<div class="section" id="broadcast-persist-save">
<h2>Broadcast, Persist, &amp; Save<a class="headerlink" href="#broadcast-persist-save" title="Permalink to this headline">¶</a></h2>
<p>Default values for the broadcast, persist, and save arguments of set_dataset() can be tailored to the model when it’s behavior is known.  For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">app.models.model</span> <span class="kn">import</span> <span class="o">*</span>
<span class="k">class</span> <span class="nc">RsbModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">namespace</span> <span class="o">=</span> <span class="s1">&#39;heating_rate.rsb&#39;</span>
    <span class="n">persist</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">broadcast</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">save</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">class</span> <span class="nc">MyExperiment</span><span class="p">(</span><span class="n">EnvExperiment</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">RsbModel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;ds_value&#39;</span><span class="p">,</span> <span class="mi">12345</span><span class="p">)</span>
</pre></div>
</div>
<p>Is equivalent to</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">set_dataset</span><span class="p">(</span><span class="s1">&#39;heating_rate.rsb.ds_value&#39;</span><span class="p">,</span> <span class="mi">12345</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">persist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Having to specify broadcast, persist, and save is then not necessary when you know the behavior of broadcast, persist,
and save for all datasets that will be set by the model.</p>
<p>For datasets that don’t conform to the model assumptions, defaults can still be overridden as usual by specifying the
argument.  e.g.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;ds_value&#39;</span><span class="p">,</span> <span class="mi">12345</span><span class="p">,</span> <span class="n">persist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="dataset-mirroring">
<h2>Dataset Mirroring<a class="headerlink" href="#dataset-mirroring" title="Permalink to this headline">¶</a></h2>
<p>Model’s can mirror all of their datasets to another namespace.  This is useful if you want to plot data for multiple
model’s in a single applet by having the model’s share the same mirror namespace.  Mirroring is enabled by default and
the mirror datasets are updated when either the <a class="reference internal" href="api.html#scan_framework.models.model.Model.set" title="scan_framework.models.model.Model.set"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Model::set()</span></code></a>
or <a class="reference internal" href="api.html#scan_framework.models.model.Model.mutate" title="scan_framework.models.model.Model.mutate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Model::mutate()</span></code></a> methods are called.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To disable mirroring set the models <a class="reference internal" href="api.html#scan_framework.models.model.Model.mirror" title="scan_framework.models.model.Model.mirror"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mirror</span></code></a> attribute to <code class="code docutils literal notranslate"><span class="pre">False</span></code></p>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../models.html" class="btn btn-neutral float-left" title="Using models for data processing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="fitting.html" class="btn btn-neutral float-right" title="Configuring fits" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>