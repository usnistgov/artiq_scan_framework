<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Core scan features &mdash; NIST Scan Framework For ARTIQ 2.0.0 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Relative scan ranges and auto tracking" href="auto_tracking.html" />
    <link rel="prev" title="Processing and handling of scan data" href="statistics.html" /> 
  <link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
     
        <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>
     

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> NIST Scan Framework For ARTIQ
          </a>
              <div class="version">
                2.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Installing the NIST scan framework</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../scans.html">Creating scan experiments</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">Getting Started with Scans</a></li>
<li class="toctree-l2"><a class="reference internal" href="statistics.html">Processing and handling of scan data</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Core scan features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pausing-resuming-early-termination">Pausing, resuming, &amp; early termination</a></li>
<li class="toctree-l3"><a class="reference internal" href="#passes">Passes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#broadcast-persist-and-save">Broadcast, Persist, and Save</a></li>
<li class="toctree-l3"><a class="reference internal" href="#current-scan-namespace">Current Scan Namespace</a></li>
<li class="toctree-l3"><a class="reference internal" href="#monitoring-histograms">Monitoring Histograms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#profiling">Profiling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="auto_tracking.html">Relative scan ranges and auto tracking</a></li>
<li class="toctree-l2"><a class="reference internal" href="time_freq_scans.html">Time &amp; frequency scans</a></li>
<li class="toctree-l2"><a class="reference internal" href="multiple_measurements.html">Performing multiple measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="calculations.html">Performing calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="warmup_points.html">Running warmup points</a></li>
<li class="toctree-l2"><a class="reference internal" href="monitor_histograms.html">Monitor histograms</a></li>
<li class="toctree-l2"><a class="reference internal" href="2d_scans.html">2D Scans</a></li>
<li class="toctree-l2"><a class="reference internal" href="lost_ion.html">Lost ion detection and reloading</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../models.html">Using models for data processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scans_ref.html">Scans references and API docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models_ref.html">Models reference and API docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis.html">Curve fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applets.html">Applets</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NIST Scan Framework For ARTIQ</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../scans.html">Creating scan experiments</a> &raquo;</li>
      <li>Core scan features</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/scans/core_features.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="core-scan-features">
<h1>Core scan features<a class="headerlink" href="#core-scan-features" title="Permalink to this headline">¶</a></h1>
<div class="section" id="pausing-resuming-early-termination">
<h2>Pausing, resuming, &amp; early termination<a class="headerlink" href="#pausing-resuming-early-termination" title="Permalink to this headline">¶</a></h2>
<p>By default, a scan will always yield to a higher priority experiment that has been submitted to the ARTIQ master.
Scans always complete the current scan point before checking with the scheduler if they need to pause via
<code class="code docutils literal notranslate"><span class="pre">self.scheduler.check_pause()</span></code>.  If <code class="code docutils literal notranslate"><span class="pre">self.scheduler.check_pause()</span></code> indicates that the scan needs to
yield to another experiment, the scan state is saved and the scan yields to the higher priority experiment.
After the higher priority experiment experiment completes, the scan will automatically resume at the scan point
following the scan point that was completed before yielding.</p>
<p>To disable pausing, resuming, and early termination and not incure the performance hit of
<code class="code docutils literal notranslate"><span class="pre">self.scheduler.check_pause()</span></code> set the <code class="code docutils literal notranslate"><span class="pre">enable_pausing</span></code> attribute of the scan to <code class="code docutils literal notranslate"><span class="pre">False</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyScan</span><span class="p">(</span><span class="n">Scan1D</span><span class="p">,</span> <span class="n">EnvExperiment</span><span class="p">):</span>
    <span class="n">enable_pausing</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="o">...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Not all callbacks are executed when a scan resumes after yielding.  See the <a class="reference internal" href="callbacks.html#callbacks"><span class="std std-ref">Callbacks</span></a>
section for which callbacks will execute when the scan resumes.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Models should only be registered in either the <code class="code docutils literal notranslate"><span class="pre">build()</span></code> or <code class="code docutils literal notranslate"><span class="pre">prepare()</span></code> methods since these methods
will not be executed when the scan resumes.  If a model is registered in another method, such as the
<code class="code docutils literal notranslate"><span class="pre">prepare_scan()</span></code> method, it will be re-registered when the scan resumes causing it to be registered twice.</p>
</div>
</div>
<div class="section" id="passes">
<h2>Passes<a class="headerlink" href="#passes" title="Permalink to this headline">¶</a></h2>
<p>Multiple scan passes can be performed by setting the <code class="code docutils literal notranslate"><span class="pre">npasses</span></code> gui argument.  The <code class="code docutils literal notranslate"><span class="pre">current_scan.stats.mean</span></code>
dataset will reflect the current mean values across all passses so far.</p>
</div>
<div class="section" id="broadcast-persist-and-save">
<h2>Broadcast, Persist, and Save<a class="headerlink" href="#broadcast-persist-and-save" title="Permalink to this headline">¶</a></h2>
<p>By default, scan models do not broadcast or persist data to their own namespace to minimize the amount of data shown in
the dashboard.  If <code class="code docutils literal notranslate"><span class="pre">mirror</span></code> is set to <code class="code docutils literal notranslate"><span class="pre">False</span></code>, there is no way of viewing the data except for using the
<code class="code docutils literal notranslate"><span class="pre">artiq_browser</span></code>.  By setting the model’s <code class="code docutils literal notranslate"><span class="pre">broadcast</span></code> and <code class="code docutils literal notranslate"><span class="pre">persist</span></code> attributes to <code class="code docutils literal notranslate"><span class="pre">True</span></code>, its
datasets will then be visible under the model’s namespace in the ‘Datasets’ panel of the dashboard.</p>
</div>
<div class="section" id="current-scan-namespace">
<h2>Current Scan Namespace<a class="headerlink" href="#current-scan-namespace" title="Permalink to this headline">¶</a></h2>
<p>Scan’s automatically mirror all dataset’s generated by the scan to the <code class="code docutils literal notranslate"><span class="pre">current_scan</span></code> namespace.  The scan will write
data to the following locations:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">current_scan.stats</span></code> This locations contains raw data and calculated statistical data from the scan.  See the <span class="xref std std-ref">datasets section</span> for more information.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">current_scan.fits</span></code> This location contains the line of best fit and all fitted parameters.  See the <a class="reference internal" href="../models/datasets.html#current-scan-fits-datasets"><span class="std std-ref">datasets section</span></a> for more information.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">current_scan.plots</span></code> This locaiton contains all data needed to produce plots.  See the <a class="reference internal" href="../models/datasets.html#current-scan-plots-datasets"><span class="std std-ref">datasets section</span></a> for more information.</p></li>
</ol>
</div></blockquote>
<p>Storing data in the <code class="code docutils literal notranslate"><span class="pre">current_scan</span></code> namespace can be disabled by setting the model’s <code class="code docutils literal notranslate"><span class="pre">mirror</span></code> attribute to
<code class="code docutils literal notranslate"><span class="pre">False</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mirror</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
<div class="section" id="monitoring-histograms">
<h2>Monitoring Histograms<a class="headerlink" href="#monitoring-histograms" title="Permalink to this headline">¶</a></h2>
<p>Scan models automatically generate a histogram of data collected at each scan point.  When the model’s datasets are
mutated, the histogram is calculated by the model and saved to the <code class="code docutils literal notranslate"><span class="pre">current_hist</span></code> namespace.  This allows a
measurement’s distribution to be viewed at each scan point as a scan runs.  To view these histograms,
<a class="reference internal" href="applets.html#current-hist-applet"><span class="std std-ref">create the current histogram applet</span></a>.  Monitor histograms can be disabled by setting</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">enable_histograms</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
<p>in the scan model.</p>
</div>
<div class="section" id="profiling">
<h2>Profiling<a class="headerlink" href="#profiling" title="Permalink to this headline">¶</a></h2>
<p>Scan’s can be profiled to find bottlenecks in the code.  This will only display execution times of code that runs on the
host and not on the core device.  It may be useful for finding bottlenecks in code running on the host side
(such as performing fits, etc).  To enable profiling set</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">enable_profiling</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>in the scan.</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="statistics.html" class="btn btn-neutral float-left" title="Processing and handling of scan data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="auto_tracking.html" class="btn btn-neutral float-right" title="Relative scan ranges and auto tracking" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>